<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Companion: Startup</title>
</head>
<body>
		<h1>Freedeck Connect</h1>
		<h2>Freedeck has failed to connect to the server.</h2>
		<p><strong>Freedeck is trying to connect to a locally hosted server right now.</strong></p>
		<p>Either the server took too long to start, you're hosting it elsewhere, or it's just coincidence.</p>
		<p>Anyways, input the Web Host URL. It's local, so if you think the server is on, just press Connect.</p>
		<p>You may have to press it a couple of times for whatever reason.</p>
		<label for="url" id="stat">URL of your Freedeck (If you don't know what this means, leave it as is!</label>
		<input id="url" name="url" value="http://localhost:5754" type="url">
		<p>This should look like <code>http://192.168.x.x</code></p>
		<button type="submit" value="Connect" onclick="urla = document.querySelector('#url').value; trygrab(urla)">Connect</button>
		<div class="output"></div>
	<script>
		let urla = 'http://localhost:5754'
		let tryDo = true;
		function trygrab(urlb) {
			fetch(urlb)
			.then(res=>res.status)
			.then(res => { 
				if(res == 200) window.location.href = urlb + '/companion'; 
			})
			.catch(err => {
				document.querySelector('.output').innerText = err + ' | URL: ' + urlb;
			})
		}
		setInterval(() => {
			if (!tryDo) return;
			trygrab(urla);
		}, 500);
	</script>
</body>
</html>