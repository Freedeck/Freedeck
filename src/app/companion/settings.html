<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../assets/style/app.css">
</head>

<div id="topbar">
    <h1 id="version">Loading metadata..</h1>
    <button>X</button>
</div>

<body data-page="Settings"style="overflow: scroll;">

    <div id="main">
        <h2>Settings</h2>
        <h3 id="now-playing"></h3>
        <br />
        <div class="flex">
            <button onclick="Susaudio.stopAll()">Stop All</button>
            <button onclick="universal.sendToast(universal.exportTheme())">Export Theme</button>
            <input id="theme-exported" hidden>
            <button onclick="universal.socket.emit('c-reset')">Reset Clients</button>
        </div>
        <p>Warning: Your custom theme will be removed.</p>
        <div class="flex">
            <button onclick="universal.socket.emit('c-change')">Reload all Freedeck Sessions</button>
            <button onclick="enableExperiments()">Toggle Freedeck Experiments</button>
        </div>
        <div id="console"></div>
        <div id="list" style="display: flex; flex-direction: column; gap:5px;"></div>
        <div id="keys"></div>
    </div>
    

    <!-- Libraries -->
    <script src="/socket.io/socket.io.js"></script>
    <script src="../assets/scripts/universal.js"></script>
    <script src="../assets/scripts/Susaudio.js"></script>
    <script src="../../sounds.js"></script>
    <!-- My scripts -->
    <script src="scripts/global.js"></script>
    <script src="scripts/soundboard-universal.js"></script>
    <script>
        const log = universal.load('notification_log');
        log.split(',').forEach(notif => {
            if(!atob(notif).includes('{')) return;
            const nMeta = JSON.parse(atob(notif));
            if (!nMeta.timestamp) nMeta.timestamp = 'No time found!';
            document.querySelector('#list').innerHTML += `<div class="experiment"><p>${nMeta.time}</p><p>${nMeta.page}</p><p>${nMeta.message}</p><p><small>${nMeta.timestamp}</small></p></div>`;
        })
    </script>
</body>
</html>